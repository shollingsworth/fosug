<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
<link href="../list/browse.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="list.cgi%3Flist=fosug&amp;cmd=feed&amp;feedtype=rss2" />
<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="list.cgi%3Flist=fosug&amp;cmd=feed&amp;feedtype=atom" />
<title>fosug: Thread: My first bash shell script</title>
<meta NAME="robots" CONTENT="noindex">
<meta NAME="robots" CONTENT="nofollow">
<base href="">
</head>
<body class=showthread-body>
<div class=menubar>
<a class="menu-lists" href="list.cgi.html">[Lists]</a>
<a class="menu-config" href="list.cgi%3Flist=fosug&amp;cmd=configure.html">[Configure]</a>
<a class="menu-first" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200410.html">[<<]</a>
<a class="menu-prev" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200508.html">[<]</a>
<a class="menu-bythread" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200509.html">[by Thread]</a>
<a class="menu-bydate" href="list.cgi%3Flist=fosug&amp;cmd=monthbydate&amp;month=200509.html">[by Date]</a>
<a class="menu-next" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200510.html">[>]</a>
<a class="menu-last" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200607.html">[>>]</a>
<a class="menu-months" href="list.cgi%3Flist=fosug&amp;cmd=months.html">[Months]</a>
<a class="menu-search" href="list.cgi%3Flist=fosug&amp;cmd=search.html">[Search]</a>
<a class="menu-subscribe" href="mailto:fosug-subscribe@fosug.org?subject=Just click SEND">[eSubscribe]</a>
<a class="feed-link" href="list.cgi%3Flist=fosug&amp;cmd=feed">[Feed]</a>
</div>
<hr>
<div class=showthread-title><h1>fosug: Thread: My first bash shell script</h1></div>
<hr>
<table class=msgs><tr><td colspan=99 class=pager>
<span class="pager-first">[<<]</span>
<span class="pager-prev">[<]</span>
<span class="pager-curr">Page 1 of 1</span>
<span class="pager-next">[>]</span>
<span class="pager-last">[>>]</span>
</td></tr><tr><td class=msgsitem><b>Subject:</b>
<a href="mailto:fosug@fosug.org?subject=Re: My first bash shell script">My first bash shell script</a>
<br><b>From:</b>
<a class="author" href="list.cgi%3Flist=fosug&amp;cmd=author&amp;authorid=phnejcnpkfifbncbfgmj&amp;month=200509.html">Joel Searcy ####@####.####</a>
<br><b>Date:</b>
18 Sep 2005 08:52:28 -0000
<br><b>Message-Id:</b> &lt;20050918085225.42641.qmail@web51810.mail.yahoo.com&gt;
<br>
<hr><pre>Hey guys tonight during my spare time at work I
finally finished my first useful bash shell script for
automating log file backups to another direcotry.  I
would like your opinions and if you have any
suggestions or ideas as how to improve it or problems
with the syntax please feel free to point it out.  I
put multiple controls in case something went wrong it
wouldn't automatically erase the log file and tried to
use standard naming conventions.


#log backup script, run as root on a nightly basis @
midnight
#!/bin/bash

LOGBACK=/logbackups
LOGDIR=/var/log
CURDATE=$(date +%Y.%m.%d.)
CURTIME=$(date +%T)
ROOT_UID=0
LOG_MES=messages
LOG_SEC=secure

if [ &quot;$UID&quot; -ne &quot;$ROOT_UID&quot; ]
then
  echo &quot;This script must be run as root!!!&quot;
exit
fi

cat $LOGDIR/$LOG_MES &gt;
$LOGBACK/$LOG_MES/$CURDATE$LOG_MES
cat $LOGDIR/$LOG_SEC &gt;
$LOGBACK/$LOG_SEC/$CURDATE$LOG_SEC




if [ $LOGBACK/$LOG_MES/$CURDATE$LOG_SEC ]
then
        echo &quot;&quot;$CURDATE$CURTIME&quot;Backup successful for
/var/log/messages&quot; &gt; $LOGDIR/logbackup.sh.log
cat /dev/null &gt; $LOGDIR/$LOG_MES
else
        echo &quot;&quot;$CURDATE$CURTIME&quot;There was an error
during script logbackup.sh, could not verify backup of
logfile /var/log/messages, file &quot;$\
CURDATE$LOG_MES&quot; does not exist&quot;
exit
fi



if [ $LOGBACK/$LOG_SEC/$CURDATE$LOG_SEC ]
then
        echo &quot;&quot;$CURDATE$CURTIME&quot;Backup successful for
/var/log/secure&quot; &gt; $LOGDIR/logbackup.sh.log
cat /dev/null &gt; $LOGDIR/$LOG_SEC
else
        echo &quot;&quot;$CURDATE$CURTIME&quot;There was an error
during script logbcak.sh, could not verify backup of
logfile /var/log/secure, file &quot;$CURD\
ATE$LOG_MES&quot; does not exist&quot;
exit
fi



__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
<a href="http://mail.yahoo.com">http://mail.yahoo.com</a> 
</pre>

<tr><td class=msgsitem><b>Subject:</b>
<a href="mailto:fosug@fosug.org?subject=Re: Re: My first bash shell script">Re: My first bash shell script</a>
<br><b>From:</b>
<a class="author" href="list.cgi%3Flist=fosug&amp;cmd=author&amp;authorid=kllfcpgdhhehicjdgkme&amp;month=200509.html">Robert Nickel ####@####.####</a>
<br><b>Date:</b>
20 Sep 2005 14:21:59 -0000
<br><b>Message-Id:</b> &lt;20050920142153.GO5928@homebase.hsd1.ca.comcast.net))&gt;
<br>
<hr><pre>On 2005.09.18 01:52:25 -0700, Joel Searcy wrote:
&gt; Hey guys tonight during my spare time at work I
&gt; finally finished my first useful bash shell script for
&gt; automating log file backups to another direcotry.  I
&gt; would like your opinions and if you have any
&gt; suggestions or ideas as how to improve it or problems
&gt; with the syntax please feel free to point it out.  I
&gt; put multiple controls in case something went wrong it
&gt; wouldn't automatically erase the log file and tried to
&gt; use standard naming conventions.
[snip script]

I have two suggestions.  These are more portability and style issues, but
there are also valid security reasons.

1)  For all of your variable usage, enclose the variable in curly braces {}.
    This prevents ambiguity and difficult debugging problems later in life if
    you're using just the $VAR version instead of ${VAR}.  A simple example of
    the problem shows up if you use something like this:

      #!/bin/bash

      VAR1=&quot;foo&quot;;
      VAR2=&quot;$VAR1bar&quot;;
      echo $VAR1
      echo $VAR2

    The correct version would be this:

      #!/bin/bash

      VAR1=&quot;foo&quot;;
      VAR2=&quot;${VAR1}bar&quot;;
      echo ${VAR1}
      echo ${VAR2}

    The first outputs:
      
      foo
      &lt;blank line&gt;
    
    The second outputs what you expect:

      foo
      foobar

    Neither offers any error for syntax.

2)  Use full paths to the executables in your script.  This keeps someone from
    manipulating ${PATH} to point to an executable of the same name with suid
    scripts.

    Alternately, you could (some would say should) specify your own ${PATH}
    inside of the script.

--Robert
</pre>

<tr><td colspan=99 class=pager>
<span class="pager-first">[<<]</span>
<span class="pager-prev">[<]</span>
<span class="pager-curr">Page 1 of 1</span>
<span class="pager-next">[>]</span>
<span class="pager-last">[>>]</span>
</td></tr></table><hr><div class=menubar>
<a class="menu-lists" href="list.cgi.html">[Lists]</a>
<a class="menu-config" href="list.cgi%3Flist=fosug&amp;cmd=configure.html">[Configure]</a>
<a class="menu-first" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200410.html">[<<]</a>
<a class="menu-prev" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200508.html">[<]</a>
<a class="menu-bythread" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200509.html">[by Thread]</a>
<a class="menu-bydate" href="list.cgi%3Flist=fosug&amp;cmd=monthbydate&amp;month=200509.html">[by Date]</a>
<a class="menu-next" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200510.html">[>]</a>
<a class="menu-last" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200607.html">[>>]</a>
<a class="menu-months" href="list.cgi%3Flist=fosug&amp;cmd=months.html">[Months]</a>
<a class="menu-search" href="list.cgi%3Flist=fosug&amp;cmd=search.html">[Search]</a>
<a class="menu-subscribe" href="mailto:fosug-subscribe@fosug.org?subject=Just click SEND">[eSubscribe]</a>
<a class="feed-link" href="list.cgi%3Flist=fosug&amp;cmd=feed">[Feed]</a>
</div>

<hr>
<div class=versioninfo>
Powered by
<a href="http://untroubled.org/ezmlm-browse/">ezmlm-browse 0.10</a>.
</div>
</body>
</html>
